{% extends "base.html" %}
{% block content %}
<div class="container mx-auto px-4 py-8 max-w-4xl">
  <div class="text-center mb-8">
    <h1 class="text-4xl font-bold text-gray-900 mb-4">Edit Job Review</h1>
    <p class="text-xl text-gray-600">
      Update your review for {{ review.practice_name }} in {{ review.location }}
    </p>
  </div>

  <form method="POST" class="bg-white rounded-lg shadow-lg p-8">
    {{ form.hidden_tag() }}
    
    <!-- Practice Information -->
    <div class="space-y-6">
      <h2 class="text-2xl font-bold text-gray-900 border-b pb-2">Practice Information</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label for="{{ form.practice_name.id }}" class="block text-sm font-medium text-gray-700 mb-2">
            {{ form.practice_name.label }}
          </label>
          <div class="space-y-3">
            <!-- Practice Name Dropdown -->
            <div>
              <label for="practice-dropdown" class="block text-xs font-medium text-gray-600 mb-1">Select from existing practices:</label>
              <select id="practice-dropdown" class="filter-input w-full" onchange="selectPractice()">
                <option value="">Choose a practice...</option>
                {% for practice in practice_names %}
                <option value="{{ practice }}">{{ practice }}</option>
                {% endfor %}
              </select>
            </div>
            
            <!-- Or enter new practice name -->
            <div>
              <label for="{{ form.practice_name.id }}" class="block text-xs font-medium text-gray-600 mb-1">Or enter a new practice name:</label>
              {{ form.practice_name(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent", id="practice-name-input") }}
            </div>
          </div>
          {% if form.practice_name.errors %}
            <div class="text-red-600 text-sm mt-1">
              {% for error in form.practice_name.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
        
        <div>
          <label for="{{ form.location.id }}" class="block text-sm font-medium text-gray-700 mb-2">
            {{ form.location.label }}
          </label>
          {{ form.location(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent") }}
          {% if form.location.errors %}
            <div class="text-red-600 text-sm mt-1">
              {% for error in form.location.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
        <div>
          <label for="{{ form.practice_type.id }}" class="block text-sm font-medium text-gray-700 mb-2">
            {{ form.practice_type.label }}
          </label>
          {{ form.practice_type(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent") }}
          {% if form.practice_type.errors %}
            <div class="text-red-600 text-sm mt-1">
              {% for error in form.practice_type.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
        
        <div>
          <label for="{{ form.specialty.id }}" class="block text-sm font-medium text-gray-700 mb-2">
            {{ form.specialty.label }}
          </label>
          {{ form.specialty(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent") }}
          {% if form.specialty.errors %}
            <div class="text-red-600 text-sm mt-1">
              {% for error in form.specialty.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Ratings -->
    <div class="space-y-6 mt-8">
      <h2 class="text-2xl font-bold text-gray-900 border-b pb-2">Ratings</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label for="{{ form.work_life_balance.id }}" class="block text-sm font-medium text-gray-700 mb-2">
            {{ form.work_life_balance.label }}
          </label>
          {{ form.work_life_balance(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent") }}
          {% if form.work_life_balance.errors %}
            <div class="text-red-600 text-sm mt-1">
              {% for error in form.work_life_balance.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
        
        <div>
          <label for="{{ form.compensation.id }}" class="block text-sm font-medium text-gray-700 mb-2">
            {{ form.compensation.label }}
          </label>
          {{ form.compensation(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent") }}
          {% if form.compensation.errors %}
            <div class="text-red-600 text-sm mt-1">
              {% for error in form.compensation.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
        
        <div>
          <label for="{{ form.culture.id }}" class="block text-sm font-medium text-gray-700 mb-2">
            {{ form.culture.label }}
          </label>
          {{ form.culture(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent") }}
          {% if form.culture.errors %}
            <div class="text-red-600 text-sm mt-1">
              {% for error in form.culture.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
        
        <div>
          <label for="{{ form.growth_opportunities.id }}" class="block text-sm font-medium text-gray-700 mb-2">
            {{ form.growth_opportunities.label }}
          </label>
          {{ form.growth_opportunities(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent") }}
          {% if form.growth_opportunities.errors %}
            <div class="text-red-600 text-sm mt-1">
              {% for error in form.growth_opportunities.errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
      
      <div>
        <label for="{{ form.overall_rating.id }}" class="block text-sm font-medium text-gray-700 mb-2">
          {{ form.overall_rating.label }}
        </label>
        {{ form.overall_rating(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent") }}
        {% if form.overall_rating.errors %}
          <div class="text-red-600 text-sm mt-1">
            {% for error in form.overall_rating.errors %}
              {{ error }}
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>

    <!-- Detailed Review -->
    <div class="space-y-6 mt-8">
      <h2 class="text-2xl font-bold text-gray-900 border-b pb-2">Detailed Review</h2>
      
      <div>
        <label for="{{ form.review_text.id }}" class="block text-sm font-medium text-gray-700 mb-2">
          {{ form.review_text.label }}
        </label>
        {{ form.review_text(class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent", rows="6", placeholder="Share your detailed experience, pros and cons, and any advice for other radiologists...") }}
        {% if form.review_text.errors %}
          <div class="text-red-600 text-sm mt-1">
            {% for error in form.review_text.errors %}
              {{ error }}
            {% endfor %}
          </div>
        {% endif %}
        <p class="text-sm text-gray-500 mt-1">Optional but highly valuable for other users</p>
      </div>
    </div>

    <!-- Privacy Options -->
    <div class="space-y-6 mt-8">
      <h2 class="text-2xl font-bold text-gray-900 border-b pb-2">Privacy Options</h2>
      
      <div class="flex items-center">
        {{ form.is_anonymous(class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded") }}
        <label for="{{ form.is_anonymous.id }}" class="ml-2 block text-sm text-gray-900">
          Submit this review anonymously (your name will not be displayed)
        </label>
      </div>
      {% if form.is_anonymous.errors %}
        <div class="text-red-600 text-sm mt-1">
          {% for error in form.is_anonymous.errors %}
            {{ error }}
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <!-- Submit Buttons -->
    <div class="flex justify-between items-center mt-8 pt-6 border-t">
      <a href="{{ url_for('job_reviews.index') }}" 
         class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200">
        Cancel
      </a>
      <button type="submit" 
              class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition-colors duration-200">
        Update Review
      </button>
    </div>
  </form>
</div>

<style>
  .container {
    max-width: 1200px;
  }
  
  @media (max-width: 768px) {
    .grid {
      grid-template-columns: 1fr;
    }
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const practiceInput = document.getElementById('practice-name-input');
    const practiceDropdown = document.getElementById('practice-dropdown');
    
    // Function to select practice from dropdown
    window.selectPractice = function() {
        const selectedValue = practiceDropdown.value;
        if (selectedValue) {
            practiceInput.value = selectedValue;
            // Clear the dropdown selection to allow re-selection
            practiceDropdown.value = '';
        }
    };
    
    // Clear dropdown when user types in the input field
    practiceInput.addEventListener('input', function() {
        if (this.value.trim() !== '') {
            practiceDropdown.value = '';
        }
    });
});
</script>
{% endblock %}

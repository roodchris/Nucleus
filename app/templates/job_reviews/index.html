{% extends "base.html" %}
{% block content %}
  <!-- Page Header -->
  <div class="page-header">
    <h1 class="page-title page-title-animated">Job Reviews</h1>
    <p class="page-subtitle page-subtitle-animated">Read reviews from attending physicians about their current and previous practice experiences</p>
    {% if reviews %}
    <p class="page-stats">
      Showing {{ reviews|length }} review{{ 's' if reviews|length != 1 else '' }}
    </p>
    {% endif %}
  </div>

  <!-- Submit Review Button -->
  {% if current_user.role.value in ['resident', 'employer'] %}
  <div class="submit-review-section">
    <a href="{{ url_for('job_reviews.submit_review') }}" class="submit-review-btn">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Submit a Job Review
    </a>
  </div>
  {% else %}
  <div class="login-prompt">
    <div class="login-prompt-content">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4M10 17l5-5-5-5M13.8 12H3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <p>Please log in to submit job reviews.</p>
    </div>
  </div>
  {% endif %}

  <!-- Filter Section -->
  <div class="filters-card">
    <div class="filters-header">
      <h3>üîç Filter Reviews</h3>
      <button type="button" class="filters-toggle" onclick="toggleFilters()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
    
    <form method="GET" action="{{ url_for('job_reviews.index') }}" class="filters-form" id="filters-form">
      <div class="filters-grid">
        <div class="filter-group">
          <label class="filter-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Practice Name
          </label>
          <select name="practice_name" id="practice_name" class="filter-input">
            <option value="">All Practices</option>
            {% for practice in practice_names %}
            <option value="{{ practice }}" {% if request.args.get('practice_name') == practice %}selected{% endif %}>
              {{ practice }}
            </option>
            {% endfor %}
          </select>
        </div>
        
        <div class="filter-group">
          <label class="filter-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M3 4h18v16H3z" stroke="currentColor" stroke-width="2"/>
              <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
              <path d="M7 20c1.5-2 3.5-3 5-3s3.5 1 5 3" stroke="currentColor" stroke-width="2"/>
            </svg>
            State
          </label>
          <select name="state" id="state" class="filter-input">
            <option value="">All States</option>
            <option value="AL" {% if request.args.get('state') == 'AL' %}selected{% endif %}>Alabama</option>
            <option value="AK" {% if request.args.get('state') == 'AK' %}selected{% endif %}>Alaska</option>
            <option value="AZ" {% if request.args.get('state') == 'AZ' %}selected{% endif %}>Arizona</option>
            <option value="AR" {% if request.args.get('state') == 'AR' %}selected{% endif %}>Arkansas</option>
            <option value="CA" {% if request.args.get('state') == 'CA' %}selected{% endif %}>California</option>
            <option value="CO" {% if request.args.get('state') == 'CO' %}selected{% endif %}>Colorado</option>
            <option value="CT" {% if request.args.get('state') == 'CT' %}selected{% endif %}>Connecticut</option>
            <option value="DE" {% if request.args.get('state') == 'DE' %}selected{% endif %}>Delaware</option>
            <option value="FL" {% if request.args.get('state') == 'FL' %}selected{% endif %}>Florida</option>
            <option value="GA" {% if request.args.get('state') == 'GA' %}selected{% endif %}>Georgia</option>
            <option value="HI" {% if request.args.get('state') == 'HI' %}selected{% endif %}>Hawaii</option>
            <option value="ID" {% if request.args.get('state') == 'ID' %}selected{% endif %}>Idaho</option>
            <option value="IL" {% if request.args.get('state') == 'IL' %}selected{% endif %}>Illinois</option>
            <option value="IN" {% if request.args.get('state') == 'IN' %}selected{% endif %}>Indiana</option>
            <option value="IA" {% if request.args.get('state') == 'IA' %}selected{% endif %}>Iowa</option>
            <option value="KS" {% if request.args.get('state') == 'KS' %}selected{% endif %}>Kansas</option>
            <option value="KY" {% if request.args.get('state') == 'KY' %}selected{% endif %}>Kentucky</option>
            <option value="LA" {% if request.args.get('state') == 'LA' %}selected{% endif %}>Louisiana</option>
            <option value="ME" {% if request.args.get('state') == 'ME' %}selected{% endif %}>Maine</option>
            <option value="MD" {% if request.args.get('state') == 'MD' %}selected{% endif %}>Maryland</option>
            <option value="MA" {% if request.args.get('state') == 'MA' %}selected{% endif %}>Massachusetts</option>
            <option value="MI" {% if request.args.get('state') == 'MI' %}selected{% endif %}>Michigan</option>
            <option value="MN" {% if request.args.get('state') == 'MN' %}selected{% endif %}>Minnesota</option>
            <option value="MS" {% if request.args.get('state') == 'MS' %}selected{% endif %}>Mississippi</option>
            <option value="MO" {% if request.args.get('state') == 'MO' %}selected{% endif %}>Missouri</option>
            <option value="MT" {% if request.args.get('state') == 'MT' %}selected{% endif %}>Montana</option>
            <option value="NE" {% if request.args.get('state') == 'NE' %}selected{% endif %}>Nebraska</option>
            <option value="NV" {% if request.args.get('state') == 'NV' %}selected{% endif %}>Nevada</option>
            <option value="NH" {% if request.args.get('state') == 'NH' %}selected{% endif %}>New Hampshire</option>
            <option value="NJ" {% if request.args.get('state') == 'NJ' %}selected{% endif %}>New Jersey</option>
            <option value="NM" {% if request.args.get('state') == 'NM' %}selected{% endif %}>New Mexico</option>
            <option value="NY" {% if request.args.get('state') == 'NY' %}selected{% endif %}>New York</option>
            <option value="NC" {% if request.args.get('state') == 'NC' %}selected{% endif %}>North Carolina</option>
            <option value="ND" {% if request.args.get('state') == 'ND' %}selected{% endif %}>North Dakota</option>
            <option value="OH" {% if request.args.get('state') == 'OH' %}selected{% endif %}>Ohio</option>
            <option value="OK" {% if request.args.get('state') == 'OK' %}selected{% endif %}>Oklahoma</option>
            <option value="OR" {% if request.args.get('state') == 'OR' %}selected{% endif %}>Oregon</option>
            <option value="PA" {% if request.args.get('state') == 'PA' %}selected{% endif %}>Pennsylvania</option>
            <option value="RI" {% if request.args.get('state') == 'RI' %}selected{% endif %}>Rhode Island</option>
            <option value="SC" {% if request.args.get('state') == 'SC' %}selected{% endif %}>South Carolina</option>
            <option value="SD" {% if request.args.get('state') == 'SD' %}selected{% endif %}>South Dakota</option>
            <option value="TN" {% if request.args.get('state') == 'TN' %}selected{% endif %}>Tennessee</option>
            <option value="TX" {% if request.args.get('state') == 'TX' %}selected{% endif %}>Texas</option>
            <option value="UT" {% if request.args.get('state') == 'UT' %}selected{% endif %}>Utah</option>
            <option value="VT" {% if request.args.get('state') == 'VT' %}selected{% endif %}>Vermont</option>
            <option value="VA" {% if request.args.get('state') == 'VA' %}selected{% endif %}>Virginia</option>
            <option value="WA" {% if request.args.get('state') == 'WA' %}selected{% endif %}>Washington</option>
            <option value="WV" {% if request.args.get('state') == 'WV' %}selected{% endif %}>West Virginia</option>
            <option value="WI" {% if request.args.get('state') == 'WI' %}selected{% endif %}>Wisconsin</option>
            <option value="WY" {% if request.args.get('state') == 'WY' %}selected{% endif %}>Wyoming</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label class="filter-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M19 21V5a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5m-4 0h4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Practice Type
          </label>
          <select name="practice_type" id="practice_type" class="filter-input">
            <option value="">All Types</option>
            <option value="Private Practice" {% if request.args.get('practice_type') == 'Private Practice' %}selected{% endif %}>Private Practice</option>
            <option value="Academic" {% if request.args.get('practice_type') == 'Academic' %}selected{% endif %}>Academic</option>
            <option value="Hospital Employed" {% if request.args.get('practice_type') == 'Hospital Employed' %}selected{% endif %}>Hospital Employed</option>
            <option value="Government" {% if request.args.get('practice_type') == 'Government' %}selected{% endif %}>Government</option>
            <option value="Telemedicine" {% if request.args.get('practice_type') == 'Telemedicine' %}selected{% endif %}>Telemedicine</option>
            <option value="1099 Contractor" {% if request.args.get('practice_type') == '1099 Contractor' %}selected{% endif %}>1099 Contractor</option>
            <option value="Other" {% if request.args.get('practice_type') == 'Other' %}selected{% endif %}>Other</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label class="filter-label">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M4 7h16M7 12h10M10 17h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            Medical Specialty
          </label>
          <select name="specialty" id="specialty" class="filter-input">
            <option value="">All Specialties</option>
            <option value="NON_CLINICAL_OTHER" {% if request.args.get('specialty') == 'NON_CLINICAL_OTHER' %}selected{% endif %}>Non-clinical/Other</option>
            <option value="AEROSPACE_MEDICINE" {% if request.args.get('specialty') == 'AEROSPACE_MEDICINE' %}selected{% endif %}>Aerospace Medicine</option>
            <option value="ANESTHESIOLOGY" {% if request.args.get('specialty') == 'ANESTHESIOLOGY' %}selected{% endif %}>Anesthesiology</option>
            <option value="CHILD_NEUROLOGY" {% if request.args.get('specialty') == 'CHILD_NEUROLOGY' %}selected{% endif %}>Child Neurology</option>
            <option value="DERMATOLOGY" {% if request.args.get('specialty') == 'DERMATOLOGY' %}selected{% endif %}>Dermatology</option>
            <option value="EMERGENCY_MEDICINE" {% if request.args.get('specialty') == 'EMERGENCY_MEDICINE' %}selected{% endif %}>Emergency Medicine</option>
            <option value="FAMILY_MEDICINE" {% if request.args.get('specialty') == 'FAMILY_MEDICINE' %}selected{% endif %}>Family Medicine</option>
            <option value="INTERNAL_MEDICINE" {% if request.args.get('specialty') == 'INTERNAL_MEDICINE' %}selected{% endif %}>Internal Medicine</option>
            <option value="MEDICAL_GENETICS" {% if request.args.get('specialty') == 'MEDICAL_GENETICS' %}selected{% endif %}>Medical Genetics</option>
            <option value="INTERVENTIONAL_RADIOLOGY" {% if request.args.get('specialty') == 'INTERVENTIONAL_RADIOLOGY' %}selected{% endif %}>Interventional Radiology</option>
            <option value="NEUROLOGICAL_SURGERY" {% if request.args.get('specialty') == 'NEUROLOGICAL_SURGERY' %}selected{% endif %}>Neurological Surgery</option>
            <option value="NEUROLOGY" {% if request.args.get('specialty') == 'NEUROLOGY' %}selected{% endif %}>Neurology</option>
            <option value="NUCLEAR_MEDICINE" {% if request.args.get('specialty') == 'NUCLEAR_MEDICINE' %}selected{% endif %}>Nuclear Medicine</option>
            <option value="OBSTETRICS_GYNECOLOGY" {% if request.args.get('specialty') == 'OBSTETRICS_GYNECOLOGY' %}selected{% endif %}>Obstetrics and Gynecology</option>
            <option value="OCCUPATIONAL_ENVIRONMENTAL_MEDICINE" {% if request.args.get('specialty') == 'OCCUPATIONAL_ENVIRONMENTAL_MEDICINE' %}selected{% endif %}>Occupational and Environmental Medicine</option>
            <option value="ORTHOPAEDIC_SURGERY" {% if request.args.get('specialty') == 'ORTHOPAEDIC_SURGERY' %}selected{% endif %}>Orthopaedic Surgery</option>
            <option value="OTOLARYNGOLOGY" {% if request.args.get('specialty') == 'OTOLARYNGOLOGY' %}selected{% endif %}>Otolaryngology - Head and Neck Surgery</option>
            <option value="PATHOLOGY" {% if request.args.get('specialty') == 'PATHOLOGY' %}selected{% endif %}>Pathology-Anatomic and Clinical</option>
            <option value="PEDIATRICS" {% if request.args.get('specialty') == 'PEDIATRICS' %}selected{% endif %}>Pediatrics</option>
            <option value="PHYSICAL_MEDICINE_REHABILITATION" {% if request.args.get('specialty') == 'PHYSICAL_MEDICINE_REHABILITATION' %}selected{% endif %}>Physical Medicine and Rehabilitation</option>
            <option value="PLASTIC_SURGERY" {% if request.args.get('specialty') == 'PLASTIC_SURGERY' %}selected{% endif %}>Plastic Surgery</option>
            <option value="PSYCHIATRY" {% if request.args.get('specialty') == 'PSYCHIATRY' %}selected{% endif %}>Psychiatry</option>
            <option value="RADIATION_ONCOLOGY" {% if request.args.get('specialty') == 'RADIATION_ONCOLOGY' %}selected{% endif %}>Radiation Oncology</option>
            <option value="RADIOLOGY_DIAGNOSTIC" {% if request.args.get('specialty') == 'RADIOLOGY_DIAGNOSTIC' %}selected{% endif %}>Radiology-Diagnostic</option>
            <option value="GENERAL_SURGERY" {% if request.args.get('specialty') == 'GENERAL_SURGERY' %}selected{% endif %}>General Surgery</option>
            <option value="THORACIC_SURGERY" {% if request.args.get('specialty') == 'THORACIC_SURGERY' %}selected{% endif %}>Thoracic Surgery</option>
            <option value="UROLOGY" {% if request.args.get('specialty') == 'UROLOGY' %}selected{% endif %}>Urology</option>
            <option value="VASCULAR_SURGERY" {% if request.args.get('specialty') == 'VASCULAR_SURGERY' %}selected{% endif %}>Vascular Surgery</option>
          </select>
        </div>
        
        <div class="filter-actions">
          <button type="submit" class="btn primary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Filter
          </button>
          {% if request.args.get('practice_name') or request.args.get('state') or request.args.get('practice_type') or request.args.get('specialty') %}
          <a href="{{ url_for('job_reviews.index') }}" class="btn secondary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M6 18L18 6M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Clear
          </a>
          {% endif %}
        </div>
      </div>
    </form>
  </div>

  <!-- Practice Statistics -->
  {% if practice_stats %}
  <div class="practice-stats-container">
    {% for practice_name, stats in practice_stats.items() %}
    <div class="practice-stats-card">
      <div class="practice-stats-header">
        <h3 class="practice-stats-title">{{ practice_name }}</h3>
        <div class="practice-stats-subtitle">{{ stats.review_count }} review{{ 's' if stats.review_count != 1 else '' }}</div>
      </div>
      
      <div class="practice-stats-grid">
        {% if stats.overall_avg %}
        <div class="stat-item">
          <div class="stat-label">Overall Rating</div>
          <div class="stat-value">
            <span class="rating-badge rating-{{ stats.overall_avg|int }}">{{ stats.overall_avg }}/5</span>
            <span class="stat-count">({{ stats.overall_count }})</span>
          </div>
        </div>
        {% endif %}
        
        {% if stats.work_life_avg %}
        <div class="stat-item">
          <div class="stat-label">Work-Life Balance</div>
          <div class="stat-value">
            <span class="rating-badge rating-{{ stats.work_life_avg|int }}">{{ stats.work_life_avg }}/5</span>
            <span class="stat-count">({{ stats.work_life_count }})</span>
          </div>
        </div>
        {% endif %}
        
        {% if stats.compensation_avg %}
        <div class="stat-item">
          <div class="stat-label">Compensation</div>
          <div class="stat-value">
            <span class="rating-badge rating-{{ stats.compensation_avg|int }}">{{ stats.compensation_avg }}/5</span>
            <span class="stat-count">({{ stats.compensation_count }})</span>
          </div>
        </div>
        {% endif %}
        
        {% if stats.culture_avg %}
        <div class="stat-item">
          <div class="stat-label">Culture</div>
          <div class="stat-value">
            <span class="rating-badge rating-{{ stats.culture_avg|int }}">{{ stats.culture_avg }}/5</span>
            <span class="stat-count">({{ stats.culture_count }})</span>
          </div>
        </div>
        {% endif %}
        
        {% if stats.growth_avg %}
        <div class="stat-item">
          <div class="stat-label">Growth Opportunities</div>
          <div class="stat-value">
            <span class="rating-badge rating-{{ stats.growth_avg|int }}">{{ stats.growth_avg }}/5</span>
            <span class="stat-count">({{ stats.growth_count }})</span>
          </div>
        </div>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Reviews Grid -->
  {% if reviews %}
  <div class="reviews-container">
    <div class="reviews-grid">
      {% for review in reviews %}
      <div class="review-card">
        <div class="review-header">
          <div class="review-icon">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="review-title">
            <h3 class="practice-name">{{ review.practice_name }}</h3>
            <p class="reviewer-info">
              {% if review.is_anonymous %}
                Anonymous ‚Ä¢ <span data-timestamp="{{ review.created_at.isoformat() }}" data-format="date">{{ review.created_at.strftime('%B %d, %Y') }}</span>
              {% else %}
                {{ review.user.name }} ‚Ä¢ <span data-timestamp="{{ review.created_at.isoformat() }}" data-format="date">{{ review.created_at.strftime('%B %d, %Y') }}</span>
              {% endif %}
            </p>
          </div>
          <div class="review-actions">
            {% if current_user.id == review.user_id %}
            <a href="{{ url_for('job_reviews.edit_review', review_id=review.id) }}" class="btn secondary">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Edit
            </a>
            {% endif %}
          </div>
        </div>
        
        <div class="review-details">
          <div class="detail-row">
            <span class="detail-label">Location</span>
            <span class="detail-value">{{ review.location }}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Practice Type</span>
            <span class="detail-value">{{ review.practice_type or 'N/A' }}</span>
          </div>
          {% if review.specialty %}
          <div class="detail-row">
            <span class="detail-label">Medical Specialty</span>
            <span class="specialty-bubble">
              {% if review.specialty == 'NON_CLINICAL_OTHER' %}Non-clinical/Other
              {% elif review.specialty == 'AEROSPACE_MEDICINE' %}Aerospace Medicine
              {% elif review.specialty == 'ANESTHESIOLOGY' %}Anesthesiology
              {% elif review.specialty == 'CHILD_NEUROLOGY' %}Child Neurology
              {% elif review.specialty == 'DERMATOLOGY' %}Dermatology
              {% elif review.specialty == 'EMERGENCY_MEDICINE' %}Emergency Medicine
              {% elif review.specialty == 'FAMILY_MEDICINE' %}Family Medicine
              {% elif review.specialty == 'INTERNAL_MEDICINE' %}Internal Medicine
              {% elif review.specialty == 'MEDICAL_GENETICS' %}Medical Genetics
              {% elif review.specialty == 'INTERVENTIONAL_RADIOLOGY' %}Interventional Radiology
              {% elif review.specialty == 'NEUROLOGICAL_SURGERY' %}Neurological Surgery
              {% elif review.specialty == 'NEUROLOGY' %}Neurology
              {% elif review.specialty == 'NUCLEAR_MEDICINE' %}Nuclear Medicine
              {% elif review.specialty == 'OBSTETRICS_GYNECOLOGY' %}Obstetrics and Gynecology
              {% elif review.specialty == 'OCCUPATIONAL_ENVIRONMENTAL_MEDICINE' %}Occupational and Environmental Medicine
              {% elif review.specialty == 'ORTHOPAEDIC_SURGERY' %}Orthopaedic Surgery
              {% elif review.specialty == 'OTOLARYNGOLOGY' %}Otolaryngology - Head and Neck Surgery
              {% elif review.specialty == 'PATHOLOGY' %}Pathology-Anatomic and Clinical
              {% elif review.specialty == 'PEDIATRICS' %}Pediatrics
              {% elif review.specialty == 'PHYSICAL_MEDICINE_REHABILITATION' %}Physical Medicine and Rehabilitation
              {% elif review.specialty == 'PLASTIC_SURGERY' %}Plastic Surgery
              {% elif review.specialty == 'PSYCHIATRY' %}Psychiatry
              {% elif review.specialty == 'RADIATION_ONCOLOGY' %}Radiation Oncology
              {% elif review.specialty == 'RADIOLOGY_DIAGNOSTIC' %}Radiology-Diagnostic
              {% elif review.specialty == 'GENERAL_SURGERY' %}General Surgery
              {% elif review.specialty == 'THORACIC_SURGERY' %}Thoracic Surgery
              {% elif review.specialty == 'UROLOGY' %}Urology
              {% elif review.specialty == 'VASCULAR_SURGERY' %}Vascular Surgery
              {% else %}{{ review.specialty }}
              {% endif %}
            </span>
          </div>
          {% endif %}
        </div>
        
        <div class="review-ratings">
          <div class="rating-row">
            <span class="rating-label">Overall</span>
            <span class="rating-badge rating-{{ review.overall_rating }}">{{ review.overall_rating }}/5</span>
          </div>
          <div class="rating-row">
            <span class="rating-label">Work-Life Balance</span>
            {% if review.work_life_balance is not none %}
              <span class="rating-badge rating-{{ review.work_life_balance }}">{{ review.work_life_balance }}/5</span>
            {% else %}
              <span class="rating-badge rating-na">N/A</span>
            {% endif %}
          </div>
          <div class="rating-row">
            <span class="rating-label">Compensation</span>
            {% if review.compensation is not none %}
              <span class="rating-badge rating-{{ review.compensation }}">{{ review.compensation }}/5</span>
            {% else %}
              <span class="rating-badge rating-na">N/A</span>
            {% endif %}
          </div>
          <div class="rating-row">
            <span class="rating-label">Culture</span>
            {% if review.culture is not none %}
              <span class="rating-badge rating-{{ review.culture }}">{{ review.culture }}/5</span>
            {% else %}
              <span class="rating-badge rating-na">N/A</span>
            {% endif %}
          </div>
          <div class="rating-row">
            <span class="rating-label">Growth Opportunities</span>
            {% if review.growth_opportunities is not none %}
              <span class="rating-badge rating-{{ review.growth_opportunities }}">{{ review.growth_opportunities }}/5</span>
            {% else %}
              <span class="rating-badge rating-na">N/A</span>
            {% endif %}
          </div>
        </div>
        
        {% if review.review_text %}
        <div class="review-text-section">
          <h4 class="review-text-title">Review</h4>
          <div class="review-text-content">
            {{ review.review_text }}
          </div>
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
  </div>
  {% else %}
  <div class="empty-state">
    <div class="empty-icon">
      <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M9 12l2 2 4-4M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <h3>No reviews found</h3>
    <p>Try adjusting your filters or be the first to submit a review.</p>
  </div>
  {% endif %}

<style>
  /* Page Header */
  .page-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .page-title {
    font-size: 3rem;
    font-weight: 900;
    margin-bottom: 1rem;
    background: linear-gradient(135deg, var(--text) 0%, var(--accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .page-subtitle {
    font-size: 1.25rem;
    color: var(--text-secondary);
    font-weight: 300;
    margin-bottom: 0.5rem;
  }

  .page-stats {
    color: var(--text-secondary);
    font-size: 1rem;
  }

  /* Submit Review Section */
  .submit-review-section {
    text-align: center;
    margin-bottom: 3rem;
  }

  .submit-review-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    background: var(--accent);
    color: white;
    font-weight: 600;
    padding: 1rem 2rem;
    border-radius: 12px;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: var(--shadow);
  }

  .submit-review-btn:hover {
    background: var(--accent-dark);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }

  .login-prompt {
    text-align: center;
    margin-bottom: 3rem;
  }

  .login-prompt-content {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    background: var(--glass);
    backdrop-filter: var(--blur);
    -webkit-backdrop-filter: var(--blur);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    padding: 1rem 2rem;
    color: var(--text-secondary);
  }

  /* Filters Card */
  .filters-card {
    background: var(--glass);
    backdrop-filter: var(--blur);
    -webkit-backdrop-filter: var(--blur);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    padding: 1rem 1.5rem;
    margin-bottom: 2rem;
    box-shadow: var(--shadow);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .filters-card:hover {
    box-shadow: var(--shadow-lg);
    border-color: var(--accent);
  }

  .filters-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
  }

  .filters-header h3 {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text);
    margin: 0;
  }

  .filters-toggle {
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    padding: 0.375rem;
    border-radius: 6px;
    transition: all 0.3s ease;
  }

  .filters-toggle:hover {
    color: var(--accent);
    background: var(--accent-light);
  }

  .filters-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 0.75rem;
    margin-bottom: 1rem;
  }

  .filter-group {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .filter-label {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    font-weight: 600;
    color: var(--text);
    font-size: 0.8rem;
  }

  .filter-label svg {
    width: 14px;
    height: 14px;
  }

  .filter-input {
    padding: 0.5rem 0.75rem;
    background: var(--glass-light);
    border: 1px solid var(--glass-border-light);
    border-radius: 8px;
    color: var(--text);
    font-size: 0.85rem;
    transition: all 0.3s ease;
  }

  .filter-input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px var(--accent-light);
  }

  .filter-input::placeholder {
    color: var(--text-secondary);
  }

  .filter-actions {
    display: flex;
    gap: 0.75rem;
    align-items: end;
  }

  .btn {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
    font-size: 0.85rem;
  }

  .btn.primary {
    background: var(--accent);
    color: white;
  }

  .btn.primary:hover {
    background: var(--accent-dark);
    box-shadow: var(--accent-glow);
  }

  .btn.secondary {
    background: var(--glass);
    border: 1px solid var(--glass-border);
    color: var(--text);
  }

  .btn.secondary:hover {
    background: var(--accent-light);
    border-color: var(--accent);
    box-shadow: var(--accent-glow);
  }

  /* Reviews Grid */
  .reviews-container {
    margin-bottom: 2rem;
  }

  .reviews-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 1rem;
  }

  .review-card {
    background: var(--glass);
    backdrop-filter: var(--blur);
    -webkit-backdrop-filter: var(--blur);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    padding: 1rem 1.5rem;
    box-shadow: var(--shadow);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .review-card:hover {
    box-shadow: var(--shadow-lg);
    border-color: var(--accent);
  }

  .review-header {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    margin-bottom: 1rem;
  }

  .review-icon {
    width: 32px;
    height: 32px;
    background: var(--accent-light);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--accent);
    box-shadow: var(--accent-glow);
    flex-shrink: 0;
  }

  .review-title {
    flex: 1;
  }

  .practice-name {
    font-size: 1rem;
    font-weight: 700;
    color: var(--text);
    margin: 0 0 0.25rem 0;
  }

  .reviewer-info {
    color: var(--text-secondary);
    font-size: 0.8rem;
    margin: 0;
  }

  .review-actions {
    flex-shrink: 0;
  }

  .review-details {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }

  .detail-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0.75rem;
    background: var(--glass-light);
    border-radius: 8px;
    border: 1px solid var(--glass-border-light);
    transition: all 0.3s ease;
  }

  .detail-row:hover {
    background: var(--accent-light);
    border-color: var(--accent);
  }

  .detail-label {
    font-weight: 600;
    color: var(--text);
    font-size: 0.8rem;
  }

  .detail-value {
    color: var(--text-secondary);
    font-size: 0.8rem;
  }

  .specialty-bubble {
    display: inline-block;
    background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: var(--accent-glow);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  .review-ratings {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }

  .rating-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0.75rem;
    background: var(--glass-light);
    border-radius: 8px;
    border: 1px solid var(--glass-border-light);
    transition: all 0.3s ease;
  }

  .rating-row:hover {
    background: var(--accent-light);
    border-color: var(--accent);
  }

  .rating-label {
    font-weight: 600;
    color: var(--text);
    font-size: 0.8rem;
  }

  .rating-badge {
    display: inline-block;
    padding: 0.125rem 0.5rem;
    border-radius: 6px;
    font-weight: 600;
    font-size: 0.7rem;
    min-width: 35px;
    text-align: center;
  }

  .rating-1 { background: #ef4444; color: white; }
  .rating-2 { background: #f97316; color: white; }
  .rating-3 { background: #eab308; color: white; }
  .rating-4 { background: #22c55e; color: white; }
  .rating-5 { background: #3b82f6; color: white; }
  .rating-na { background: var(--text-muted); color: var(--text); }

  .review-text-section {
    border-top: 1px solid var(--glass-border-light);
    padding-top: 1rem;
  }

  .review-text-title {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text);
    margin: 0 0 0.75rem 0;
  }

  .review-text-content {
    color: var(--text-secondary);
    line-height: 1.5;
    font-size: 0.85rem;
    background: var(--glass-light);
    border: 1px solid var(--glass-border-light);
    border-radius: 8px;
    padding: 0.75rem;
  }

  /* Practice Statistics */
  .practice-stats-container {
    margin-bottom: 2rem;
  }

  .practice-stats-card {
    background: var(--glass);
    backdrop-filter: var(--blur);
    -webkit-backdrop-filter: var(--blur);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1rem;
    box-shadow: var(--shadow);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .practice-stats-card:hover {
    box-shadow: var(--shadow-lg);
    border-color: var(--accent);
  }

  .practice-stats-header {
    margin-bottom: 1.5rem;
    text-align: center;
  }

  .practice-stats-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text);
    margin: 0 0 0.5rem 0;
    background: linear-gradient(135deg, var(--text) 0%, var(--accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .practice-stats-subtitle {
    color: var(--text-secondary);
    font-size: 0.9rem;
    font-weight: 500;
  }

  .practice-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  }

  .stat-item {
    background: var(--glass-light);
    border: 1px solid var(--glass-border-light);
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    transition: all 0.3s ease;
  }

  .stat-item:hover {
    background: var(--accent-light);
    border-color: var(--accent);
    transform: translateY(-2px);
  }

  .stat-label {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .stat-value {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.25rem;
  }

  .stat-count {
    font-size: 0.7rem;
    color: var(--text-secondary);
    font-weight: 500;
  }

  /* Empty State */
  .empty-state {
    text-align: center;
    padding: 2rem 1.5rem;
    background: var(--glass);
    backdrop-filter: var(--blur);
    -webkit-backdrop-filter: var(--blur);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
  }

  .empty-icon {
    width: 60px;
    height: 60px;
    background: var(--accent-light);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    color: var(--accent);
  }

  .empty-state h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text);
    margin-bottom: 0.75rem;
  }

  .empty-state p {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin: 0;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .page-title {
      font-size: 2.5rem;
    }

    .filters-grid {
      grid-template-columns: 1fr;
    }

    .filter-actions {
      flex-direction: column;
      align-items: stretch;
    }

    .practice-stats-grid {
      grid-template-columns: 1fr;
      gap: 0.75rem;
    }

    .practice-stats-card {
      padding: 1rem;
    }

    .practice-stats-title {
      font-size: 1.25rem;
    }

    .stat-item {
      padding: 0.75rem;
    }

    .reviews-grid {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    .review-card {
      padding: 1.5rem;
    }

    .review-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }

    .review-icon {
      width: 40px;
      height: 40px;
    }

    .practice-name {
      font-size: 1.1rem;
    }

    .detail-row,
    .rating-row {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .btn {
      justify-content: center;
    }

    .reviews-table {
      font-size: 0.8rem;
    }

    .reviews-table th,
    .reviews-table td {
      padding: 0.75rem 0.5rem;
    }
  }
</style>

<script>
  function toggleFilters() {
    const form = document.getElementById('filters-form');
    const toggle = document.querySelector('.filters-toggle svg');
    
    if (form.style.display === 'none') {
      form.style.display = 'block';
      toggle.style.transform = 'rotate(0deg)';
    } else {
      form.style.display = 'none';
      toggle.style.transform = 'rotate(180deg)';
    }
  }
</script>
{% endblock %}
